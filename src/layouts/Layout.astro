---
import '../styles/global.css';
import { getSiteSettings } from '../services/supabase';

interface Props {
  title: string;
  description?: string;
}

const { title, description = 'Site de venda de produtos pessoais' } = Astro.props;

// Buscar configurações do site
const siteSettingsData = await getSiteSettings();
const siteSettings = siteSettingsData ? siteSettingsData : {
  projectName: 'Desapego dos Martins',
  heroTitle: 'Desapego dos Martins',
  heroDescription: 'Produtos de qualidade a preços acessíveis',
  contactPhone: '',
  contactWhatsapp: '',
  paymentMethods: '',
  whatsappMessage: ''
};

const projectName = siteSettings.projectName || 'Desapego dos Martins';

---

<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title} | {projectName}</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- Descrição para SEO -->
    <meta name="description" content={description || `${projectName} - Produtos de qualidade a preços acessíveis`} />
  </head>
  <body class="bg-neutral-50 min-h-screen flex flex-col font-sans relative">
    <!-- Padrão de fundo com textura de bolinhas estilo brocado -->
    <div class="fixed inset-0 bg-pattern-dots opacity-50 pointer-events-none z-0"></div>
    
    <!-- Elementos decorativos de casa -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none z-0">
      <!-- Elemento decorativo superior direito -->
      <div class="absolute top-0 right-0 w-64 h-64 opacity-10">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-full h-full text-primary-800">
          <path d="M11.47 3.84a.75.75 0 011.06 0l8.69 8.69a.75.75 0 101.06-1.06l-8.689-8.69a2.25 2.25 0 00-3.182 0l-8.69 8.69a.75.75 0 001.061 1.06l8.69-8.69z" />
          <path d="M12 5.432l8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 01-.75-.75v-4.5a.75.75 0 00-.75-.75h-3a.75.75 0 00-.75.75V21a.75.75 0 01-.75.75H5.625a1.875 1.875 0 01-1.875-1.875v-6.198a2.29 2.29 0 00.091-.086L12 5.43z" />
        </svg>
      </div>
      
      <!-- Elemento decorativo inferior esquerdo -->
      <div class="absolute bottom-0 left-0 w-48 h-48 opacity-10">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-full h-full text-primary-700">
          <path d="M19.006 3.705a.75.75 0 00-.512-1.41L6 6.838V3a.75.75 0 00-.75-.75h-1.5A.75.75 0 003 3v4.93l-1.006.365a.75.75 0 00.512 1.41l16.5-6z" />
          <path fill-rule="evenodd" d="M3.019 11.115L18 5.667V9.09l4.006 1.456a.75.75 0 11-.512 1.41l-.494-.18v8.475h.75a.75.75 0 010 1.5H2.25a.75.75 0 010-1.5H3v-9.129l.019-.006zM18 20.25v-9.565l1.5.545v9.02H18zm-9-6a.75.75 0 00-.75.75v4.5c0 .414.336.75.75.75h3a.75.75 0 00.75-.75V15a.75.75 0 00-.75-.75H9z" clip-rule="evenodd" />
        </svg>
      </div>
      
      <!-- Elemento decorativo central -->
      <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 opacity-5">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-full h-full text-primary-900">
          <path d="M19.5 21a3 3 0 003-3v-4.5a3 3 0 00-3-3h-15a3 3 0 00-3 3V18a3 3 0 003 3h15zM1.5 10.146V6a3 3 0 013-3h5.379a2.25 2.25 0 011.59.659l2.122 2.121c.14.141.331.22.53.22H19.5a3 3 0 013 3v1.146A4.483 4.483 0 0019.5 9h-15a4.483 4.483 0 00-3 1.146z" />
        </svg>
      </div>
    </div>
    
    <header class="bg-white shadow-soft sticky top-0 z-40 border-b border-neutral-200">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-16">
          <div class="flex items-center">
            <a href="/" class="flex-shrink-0 flex items-center group">
              <span class="text-2xl font-bold font-heading text-primary-600 group-hover:text-primary-700 transition-colors">
                <i class="fas fa-store-alt mr-2"></i>{projectName}
              </span>
            </a>
            <nav class="hidden md:ml-8 md:flex md:space-x-8">
              <a href="/" class="text-neutral-700 hover:text-primary-600 px-3 py-2 text-sm font-medium flex items-center">
                <i class="fas fa-home mr-1.5"></i>Início
              </a>
              <a href="/categoria/todos" class="text-neutral-700 hover:text-primary-600 px-3 py-2 text-sm font-medium flex items-center">
                <i class="fas fa-tags mr-1.5"></i>Categorias
              </a>
              <a href="/#produtos" class="text-neutral-700 hover:text-primary-600 px-3 py-2 text-sm font-medium flex items-center">
                <i class="fas fa-shopping-basket mr-1.5"></i>Produtos
              </a>
            </nav>
          </div>
          <div class="flex items-center">
            <a href="/admin" class="text-neutral-700 hover:text-primary-600 px-3 py-2 text-sm font-medium flex items-center">
              <i class="fas fa-user-cog mr-1.5"></i>Admin
            </a>
          </div>
        </div>
      </div>
    </header>
    
    <main class="flex-grow relative z-10">
      <slot />
    </main>
    
    <footer class="bg-neutral-900 text-white relative z-10">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div class="animate-fade-in" style="--animation-delay: 0.1s;">
            <h3 class="text-xl font-bold font-heading mb-4 text-accent-400">{projectName}</h3>
            <p class="text-neutral-300">
              {siteSettings.heroDescription || 'Produtos de qualidade a preços acessíveis. Todos os itens estão em ótimo estado e prontos para um novo lar.'}
            </p>
            <div class="mt-4 flex space-x-4">
              <a href="#" class="text-neutral-400 hover:text-accent-400 transition-colors">
                <i class="fab fa-instagram text-xl"></i>
              </a>
              <a href="#" class="text-neutral-400 hover:text-accent-400 transition-colors">
                <i class="fab fa-facebook text-xl"></i>
              </a>
              {siteSettings.contactWhatsapp && (
                <a href={`https://wa.me/${siteSettings.contactWhatsapp}`} class="text-neutral-400 hover:text-accent-400 transition-colors">
                  <i class="fab fa-whatsapp text-xl"></i>
                </a>
              )}
            </div>
          </div>
          <div class="animate-fade-in" style="--animation-delay: 0.2s;">
            <h3 class="text-xl font-bold font-heading mb-4 text-accent-400">Links rápidos</h3>
            <ul class="space-y-2">
              <li>
                <a href="/" class="text-neutral-300 hover:text-white transition-colors flex items-center">
                  <i class="fas fa-chevron-right text-xs mr-2 text-accent-400"></i>Início
                </a>
              </li>
              <li>
                <a href="/categoria/todos" class="text-neutral-300 hover:text-white transition-colors flex items-center">
                  <i class="fas fa-chevron-right text-xs mr-2 text-accent-400"></i>Categorias
                </a>
              </li>
              <li>
                <a href="/#produtos" class="text-neutral-300 hover:text-white transition-colors flex items-center">
                  <i class="fas fa-chevron-right text-xs mr-2 text-accent-400"></i>Produtos
                </a>
              </li>
            </ul>
          </div>
          <div class="animate-fade-in" style="--animation-delay: 0.3s;">
            <h3 class="text-xl font-bold font-heading mb-4 text-accent-400">Contato</h3>
            <p class="text-neutral-300 mb-4">
              Entre em contato através do WhatsApp para mais informações sobre os produtos.
            </p>
            <a href="#" class="inline-flex items-center px-4 py-2 rounded-lg bg-accent-500 hover:bg-accent-600 text-white transition-colors">
              <i class="fab fa-whatsapp mr-2"></i> Fale conosco
            </a>
          </div>
        </div>
        <div class="border-t border-neutral-800 mt-8 pt-8 text-center text-neutral-400">
          <p>&copy; {new Date().getFullYear()} {projectName}. Todos os direitos reservados.</p>
        </div>
      </div>
    </footer>
    
    <script>
      // Script para controlar a barra de pesquisa fixa
      document.addEventListener('DOMContentLoaded', function() {
        const searchBarContainer = document.getElementById('searchBarContainer');
        
        if (searchBarContainer) {
          let lastScrollTop = 0;
          
          window.addEventListener('scroll', function() {
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            
            if (scrollTop > 100) {
              searchBarContainer.classList.add('shadow-md');
              
              // Esconde a barra ao rolar para baixo e mostra ao rolar para cima
              if (scrollTop > lastScrollTop) {
                searchBarContainer.style.transform = 'translateY(-100%)';
              } else {
                searchBarContainer.style.transform = 'translateY(0)';
              }
            } else {
              searchBarContainer.classList.remove('shadow-md');
              searchBarContainer.style.transform = 'translateY(0)';
            }
            
            lastScrollTop = scrollTop;
          });
        }
      });
    </script>
  </body>
</html>

<style is:global>
  :root {
    --primary-50: #f0f7ff;
    --primary-100: #e0effe;
    --primary-200: #bae0fd;
    --primary-300: #7dcbfc;
    --primary-400: #38aef8;
    --primary-500: #0e96ed;
    --primary-600: #0279ce;
    --primary-700: #0262a7;
    --primary-800: #065286;
    --primary-900: #0a4a73;
    --primary-950: #062d48;
    
    --neutral-50: #faf8f5;
    --neutral-100: #f5f0e8;
    --neutral-200: #e9e0d2;
    --neutral-300: #d9c9b3;
    --neutral-400: #c4ab8d;
    --neutral-500: #b39170;
    --neutral-600: #a27a5a;
    --neutral-700: #86634a;
    --neutral-800: #6f5240;
    --neutral-900: #5c4437;
    --neutral-950: #302219;
  }
  
  /* Padrão de fundo com textura de bolinhas estilo brocado com mais contraste */
  .bg-pattern-dots {
    background-color: #f5f0e5;
    background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23d9c9b3' fill-opacity='0.7'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
  }
  
  /* Garantir que o site ocupe toda a largura da tela */
  html, body {
    width: 100%;
    max-width: 100%;
    overflow-x: hidden;
    margin: 0;
    padding: 0;
  }
  
  /* Corrigir problemas de layout em dispositivos móveis */
  @media (max-width: 768px) {
    .container {
      width: 100%;
      padding-left: 1rem;
      padding-right: 1rem;
      margin-left: auto;
      margin-right: auto;
    }
    
    .grid {
      margin-left: -0.5rem;
      margin-right: -0.5rem;
    }
  }
  
  /* Estilos base */
  html {
    scroll-behavior: smooth;
  }
  
  body {
    font-family: 'Poppins', system-ui, sans-serif;
    color: var(--text);
  }
  
  /* Utilitários */
  .font-sans {
    font-family: 'Poppins', system-ui, sans-serif;
  }
  
  .font-heading {
    font-family: 'Montserrat', system-ui, sans-serif;
  }
  
  .font-display {
    font-family: 'Playfair Display', serif;
  }
  
  .btn {
    @apply inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-base font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 transition-all;
  }
  
  .btn-primary {
    @apply bg-primary-600 text-white hover:bg-primary-700 hover:shadow-md focus:ring-primary-500;
  }
  
  .btn-outline {
    @apply bg-white text-neutral-700 border-neutral-300 hover:bg-neutral-50 hover:text-primary-600 focus:ring-primary-500;
  }
  
  .btn-accent {
    @apply bg-accent-500 text-white hover:bg-accent-600 hover:shadow-md focus:ring-accent-400;
  }
  
  /* Animações */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  @keyframes slideUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .animate-fade-in {
    opacity: 0;
    animation: fadeIn 0.6s ease-out forwards;
    animation-delay: var(--animation-delay, 0s);
  }
  
  .animate-slide-up {
    opacity: 0;
    animation: slideUp 0.5s ease-out forwards;
    animation-delay: var(--animation-delay, 0s);
  }
  
  /* Glassmorphism */
  .glass {
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  }
  
  /* Animação de hover para links e botões */
  a, button {
    transition: all 0.2s ease;
  }
</style>
